#if __VERSION__ >= 130
	#define varying in
	out vec4 mgl_FragColor;
	#define texture2D texture
	#define gl_FragColor mgl_FragColor
#endif
		
#ifdef GL_ES
	precision mediump float;
	precision mediump int;
#endif
		
varying   vec4    varying_Color;
varying   vec3    surfaceNormal;
varying   vec3    toLightVector;

uniform   vec3    lightColor;

void main (void)
{
	if (gl_FrontFacing)
	{
		vec3 unitNormal = normalize(surfaceNormal);
		vec3 unitLightVector = normalize(toLightVector);
		
		float nDot1 = dot(unitNormal,unitLightVector);
		float brightness = max(nDot1,0.0);
		vec3 diffuse = brightness * lightColor;
		
		gl_FragColor = vec4(diffuse,1.0) * varying_Color;
	}
	else
	{
		vec3 unitNormal = -normalize(surfaceNormal);
		vec3 unitLightVector = normalize(toLightVector);
		
		float nDot1 = dot(unitNormal,unitLightVector);
		float brightness = max(nDot1,0.0);
		vec3 diffuse = brightness * lightColor;
		
		gl_FragColor = vec4(diffuse,1.0) * varying_Color;
	}
}